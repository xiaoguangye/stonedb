use test;
CREATE TABLE t1 (f1 VARCHAR(255) CHARACTER SET utf8) ENGINE=TIANMU;
CREATE TABLE t2 AS SELECT LEFT(f1,171) AS f2 FROM t1 UNION SELECT LEFT(f1,171) AS f2 FROM t1;
INSERT INTO t2 VALUES ('a');
INSERT INTO t2 VALUES ('b');
INSERT INTO t2 VALUES ('c');
SELECT * FROM t2;
f2
a
b
c
CREATE TABLE t3 AS SELECT t1.f1 AS f3 FROM t1 LEFT JOIN t2 ON t1.f1 = t2.f2;
INSERT INTO t3 VALUES ('d');
INSERT INTO t3 VALUES ('e');
INSERT INTO t3 VALUES ('f');
SELECT * FROM t3;
f3
d
e
f
CREATE TABLE t4 AS SELECT t1.f1 AS f4 FROM t1 INNER JOIN t2 ON t1.f1 = t2.f2;
INSERT INTO t4 VALUES ('g');
INSERT INTO t4 VALUES ('h');
INSERT INTO t4 VALUES ('i');
SELECT * FROM t4;
f4
g
h
i
CREATE TABLE t5 AS SELECT t1.f1 AS f5 FROM t1 RIGHT JOIN t2 ON t1.f1 = t2.f2;
INSERT INTO t5 VALUES ('j');
INSERT INTO t5 VALUES ('k');
INSERT INTO t5 VALUES ('l');
SELECT * FROM t5;
f5
NULL
NULL
NULL
j
k
l
CREATE TABLE t6 AS SELECT t1.f1 AS f6 FROM t1 UNION SELECT t2.f2 AS f6 FROM t2 LEFT JOIN t3 ON t2.f2 = t3.f3;
INSERT INTO t6 VALUES ('m');
INSERT INTO t6 VALUES ('n');
INSERT INTO t6 VALUES ('o');
INSERT INTO t6 VALUES ('p');
INSERT INTO t6 VALUES ('q');
SELECT * FROM t6;
f6
a
b
c
m
n
o
p
q
CREATE TABLE t7 AS SELECT t1.f1 AS f7 FROM t1 UNION SELECT t2.f2 AS f7 FROM t2 INNER JOIN t3 ON t2.f2 = t3.f3;
INSERT INTO t7 VALUES ('r');
INSERT INTO t7 VALUES ('s');
INSERT INTO t7 VALUES ('t');
INSERT INTO t7 VALUES ('u');
INSERT INTO t7 VALUES ('v');
SELECT * FROM t7;
f7
r
s
t
u
v
CREATE TABLE t8 AS SELECT t1.f1 AS f8 FROM t1 UNION SELECT t2.f2 AS f8 FROM t2 RIGHT JOIN t3 ON t2.f2 = t3.f3;
INSERT INTO t8 VALUES ('w');
INSERT INTO t8 VALUES ('x');
SELECT * FROM t8;
f8
NULL
w
x
CREATE TABLE t9 AS SELECT t1.f1 AS f9 FROM t1 INNER JOIN t3 ON t1.f1 = t3.f3 UNION SELECT t2.f2 AS f9 FROM t2;
INSERT INTO t9 VALUES ('y');
INSERT INTO t9 VALUES ('z');
SELECT * FROM t9;
f9
a
b
c
y
z
DROP TABLE t1;
DROP TABLE t2;
DROP TABLE t3;
DROP TABLE t4;
DROP TABLE t5;
DROP TABLE t6;
DROP TABLE t7;
DROP TABLE t8;
DROP TABLE t9;
